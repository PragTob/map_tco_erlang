Relating to [this discussion](https://lobste.rs/s/ardzjz/tail_call_optimization_elixir_erlang_not/comments/e7zcn8#c_e7zcn8) on lobste.rs


## Erlang

```
tobi@happy ~/github/erlang_map $ erl
Erlang/OTP 18 [erts-7.3] [source-d2a6d81] [64-bit] [smp:8:8] [async-threads:10] [hipe] [kernel-poll:false]

Eshell V7.3  (abort with ^G)
1>  c(tco).
{ok,tco}
2> Data = lists:seq(1,1000000).
[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,
 23,24,25,26,27,28,29|...]
3>  Succ = fun(X) -> X + 1 end.
#Fun<erl_eval.6.50752066>
4> timer:tc(tco, map_reversed, [Data, [], Succ]).
{477397,
 [1000001,1000000,999999,999998,999997,999996,999995,999994,
  999993,999992,999991,999990,999989,999988,999987,999986,
  999985,999984,999983,999982,999981,999980,999979,999978,
  999977,999976,999975|...]}
5> timer:tc(tco, map_body, [Data, Succ]).
{826180,
 [2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,
  24,25,26,27,28|...]}
6> timer:tc(tco, map_reversed, [Data, [], Succ]).
{472715,
 [1000001,1000000,999999,999998,999997,999996,999995,999994,
  999993,999992,999991,999990,999989,999988,999987,999986,
  999985,999984,999983,999982,999981,999980,999979,999978,
  999977,999976,999975|...]}
7> timer:tc(tco, map_reversed, [Data, [], Succ]).
{471386,
 [1000001,1000000,999999,999998,999997,999996,999995,999994,
  999993,999992,999991,999990,999989,999988,999987,999986,
  999985,999984,999983,999982,999981,999980,999979,999978,
  999977,999976,999975|...]}
8> timer:tc(tco, map_reversed, [Data, [], Succ]).
{461504,
 [1000001,1000000,999999,999998,999997,999996,999995,999994,
  999993,999992,999991,999990,999989,999988,999987,999986,
  999985,999984,999983,999982,999981,999980,999979,999978,
  999977,999976,999975|...]}
9> timer:tc(tco, map_body, [Data, Succ]).        
{904630,
 [2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,
  24,25,26,27,28|...]}
10> timer:tc(tco, map_body, [Data, Succ]).
{970073,
 [2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,
  24,25,26,27,28|...]}
11> timer:tc(tco, map_body, [Data, Succ]).
{1485897,
 [2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,
  24,25,26,27,28|...]}
12> timer:tc(tco, map_body, [Data, Succ]).
{1401314,
 [2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,
  24,25,26,27,28|...]}

```

## Elixir

(using the code from my elixir_playground repo)

```
tobi@happy ~/github/elixir_playground $ iex -S mix
Erlang/OTP 18 [erts-7.3] [source-d2a6d81] [64-bit] [smp:8:8] [async-threads:10] [hipe] [kernel-poll:false]
Interactive Elixir (1.2.5) - press Ctrl+C to exit (type h() ENTER for help)
iex(1)> list = Enum.to_list 1..1000000
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42,
 43, 44, 45, 46, 47, 48, 49, 50, ...]
iex(2)> my_fun = fn(i) -> i + 1 end
#Function<6.50752066/1 in :erl_eval.expr/5>
iex(3)> :timer.tc fn -> MyMap.map_tco(list, my_fun) end
{458488,
 [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
  23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41,
  42, 43, 44, 45, 46, 47, 48, 49, 50, ...]}
iex(4)> :timer.tc fn -> MyMap.map_body(list, my_fun) end
{971825,
 [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
  23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41,
  42, 43, 44, 45, 46, 47, 48, 49, 50, ...]}
iex(5)> :timer.tc fn -> MyMap.map_tco(list, my_fun) end 
{555394,
 [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
  23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41,
  42, 43, 44, 45, 46, 47, 48, 49, 50, ...]}
iex(6)> :timer.tc fn -> MyMap.map_tco(list, my_fun) end
{505423,
 [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
  23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41,
  42, 43, 44, 45, 46, 47, 48, 49, 50, ...]}
iex(7)> :timer.tc fn -> MyMap.map_tco(list, my_fun) end
{467228,
 [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
  23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41,
  42, 43, 44, 45, 46, 47, 48, 49, 50, ...]}
iex(8)> :timer.tc fn -> MyMap.map_body(list, my_fun) end
{636665,
 [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
  23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41,
  42, 43, 44, 45, 46, 47, 48, 49, 50, ...]}
iex(9)> :timer.tc fn -> MyMap.map_body(list, my_fun) end
{493285,
 [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
  23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41,
  42, 43, 44, 45, 46, 47, 48, 49, 50, ...]}
iex(10)> :timer.tc fn -> MyMap.map_body(list, my_fun) end
{490130,
 [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
  23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41,
  42, 43, 44, 45, 46, 47, 48, 49, 50, ...]}
iex(11)> :timer.tc fn -> MyMap.map_body(list, my_fun) end
{536140,
 [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
  23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41,
  42, 43, 44, 45, 46, 47, 48, 49, 50, ...]}
```
